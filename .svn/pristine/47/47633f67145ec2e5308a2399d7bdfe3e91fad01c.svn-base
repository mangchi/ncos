<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Server">
  <update id="saveAssertStatusInfo" parameterType="map">
		INSERT INTO asset_status_info(system_id	
									, detection_time
									, asset_status
									)
							VALUES ( #{shipId}
									,SYSDATE()
									,#{asset_status}
									)
		ON DUPLICATE KEY UPDATE   
							DETECTION_TIME = SYSDATE()
						  , ASSET_STATUS = #{asset_status}
  </update>
  
  <update id="saveShipStatus" parameterType="map">
        INSERT INTO ship_status(SHIP_ID
                              , UNIT_ID
                              , DETECTION_TIME
                              , SHIP_STATUS_ID
                               )
                        VALUES(#{shipId}
                              ,#{unitId}
                              ,SYSDATE()
                              ,#{shipStatusId}
                              )
         ON DUPLICATE KEY UPDATE
                          DETECTION_TIME = SYSDATE()
                        , SHIP_STATUS_ID = #{shipStatusId}
  </update>
  
	<update id="insertThreatInfo" parameterType="map">
        INSERT INTO threat_info(
			UNIT_ID
			, SHIP_ID
			<if test='detectionTime != null and !detectionTime.equals("")'>
			, DETECTION_TIME
			</if>
			<if test='srcIp != null and !srcIp.equals("")'>
			, SRC_IP
			</if>
			<if test='dstIp != null and !dstIp.equals("")'>
			, DST_IP
			</if>
			<if test='srcPort != null and !srcPort.equals("")'>
			, SRC_PORT
			</if>
			<if test='dstPort != null and !dstPort.equals("")'>
			, DST_PORT
			</if>
			<if test='protocol != null and !protocol.equals("")'>
			, PROTOCOL
			</if>
			<if test='payloadSize != null and !payloadSize.equals("")'>
			, PAYLOAD_SIZE
			</if>
			<if test='fragmentation != null and !fragmentation.equals("")'>
			, FRAGMENTATION
			</if>
			<if test='fragmentId != null and !fragmentId.equals("")'>
			, FRAGMENT_ID
			</if>
			<if test='detectionThreatName != null and !detectionThreatName.equals("")'>
			, DETECTION_THREAT_NAME
			</if>
			<if test='threatDetectionMethod != null and !threatDetectionMethod.equals("")'>
			, THREAT_DETECTION_METHOD
			</if>
			<if test='threatImportance != null and !threatImportance.equals("")'>
			, THREAT_IMPORTANCE
			</if>
			<if test='payload != null and !payload.equals("")'>
			, PAYLOAD
			</if>
		)
		VALUES(
			#{unitId}
			,#{shipId}
			<if test='detectionTime != null and !detectionTime.equals("")'>
			,#{detectionTime}
			</if>
			<if test='srcIp != null and !srcIp.equals("")'>
			,#{srcIp}
			</if>
			<if test='dstIp != null and !dstIp.equals("")'>
			,#{dstIp}
			</if>
			<if test='srcPort != null and !srcPort.equals("")'>
			,#{srcPort}
			</if>
			<if test='dstPort != null and !dstPort.equals("")'>
			,#{dstPort}
			</if>
			<if test='protocol != null and !protocol.equals("")'>
			,#{protocol}
			</if>
			<if test='payloadSize != null and !payloadSize.equals("")'>
			,#{payloadSize}
			</if>
			<if test='fragmentation != null and !fragmentation.equals("")'>
			,#{fragmentation}
			</if>
			<if test='fragmentId != null and !fragmentId.equals("")'>
			,#{fragmentId}
			</if>
			<if test='detectionThreatName != null and !detectionThreatName.equals("")'>
			,#{detectionThreatName}
			</if>
			<if test='threatDetectionMethod != null and !threatDetectionMethod.equals("")'>
			,#{threatDetectionMethod}
			</if>
			<if test='threatImportance != null and !threatImportance.equals("")'>
			,#{threatImportance}
			</if>
			<if test='payload != null and !payload.equals("")'>
			,#{payload}
			</if>
		)
	</update>
  
  <update id="insertTransmitData" parameterType="map">
        INSERT INTO transmit_data(SRC_TIME
                                , SRC_BYTES
                                 )
                        VALUES(SYSDATE()
                              ,#{srcBytes}             
                               )
  </update>
  
   
 
   
</mapper>