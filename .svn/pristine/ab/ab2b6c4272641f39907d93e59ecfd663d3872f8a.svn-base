<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{th/cmmn/layout}">
<head>
<title>AI 학습 전시</title>
</head>
<th:block layout:fragment="content">
<div class="container-wide">
	<div class="container">
		<div class="grid-row">
			<div class="item-box col-12">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_01_01"></span><strong>AI 학습 전시</strong></h4>
				</div>
			</div>
		</div>
		<div class="grid-row">
			<div class="item-box col-3">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_01_02"></span><strong>TP (TruePositive)</strong></h4>
					<div class="items">
						<div style="padding: 30px 0;text-align: center"><span class="btn xlarge blue resultTp" style="padding-left: 50px;padding-right: 50px"></span></div>
					</div>
				</div>
			</div>
			<div class="item-box col-3">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_01_02"></span><strong>FP (FalsePositive)</strong></h4>
					<div class="items">
						<div style="padding: 30px 0;text-align: center"><span class="btn xlarge green resultFp" style="padding-left: 50px;padding-right: 50px"></span></div>
					</div>
				</div>
			</div>
			<div class="item-box col-3">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_01_02"></span><strong>FN (FalseNegative)</strong></h4>
					<div class="items"> <!-- item contnets // -->
						<div style="padding: 30px 0;text-align: center"><span class="btn xlarge orange resultFn" style="padding-left: 50px;padding-right: 50px"></span></div>
				    </div>
				</div>
			</div>
			<div class="item-box col-3">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_01_02"></span><strong>TN (TrueNegative)</strong></h4>
					<div class="items"> <!-- item contnets // -->
						<div style="padding: 30px 0;text-align: center"><span class="btn xlarge gray resultTn" style="padding-left: 50px;padding-right: 50px"></span></div>
				    </div>
				</div>
			</div>
		</div>
		<div class="grid-row">
			<div class="item-box col-12">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_search"></span><strong>조회조건</strong></h4>
					<div class="items" style="overflow: visible">
						<!-- item contnets // -->
						<div class="schwrap">
							<ul>
							<!-- 	<li>
									<label>시간
									<input id="frDt" type="datetime-local" data-placeholder="날짜 선택" value="" class="form-control"></input>
									   ~
									<input id="toDt" type="datetime-local" data-placeholder="날짜 선택" value="" class="form-control"></input>
									</label>
								</li> -->
								<li>
								    <div class="selectWrap">분류지표
										<div class="select">
											<div class="selected">
												<div data-value="" class="selected-value">전체</div>
												<div class="arrow"></div>
											</div>
											<ul id="schIndex">
											</ul>
										</div>
									</div>
								</li>
								<li>
									<label>기준점수
										<input type="text" id="schPt" class="form-control numComma" placeholder="기준점수 입력해주세요">
									</label>
								</li>
							</ul>
							<div>
							    <button class="btn medium darkblue trainBtn"><span class="iconBtn icon_movement2"></span><strong>학습</strong></button>
								<button class="btn medium darkblue initBtn"><span class="iconBtn icon_reset"></span><strong>초기화</strong></button>
								<button class="btn medium darkblue schBtn"><span class="iconBtn icon_btn_01"></span><strong>검색</strong></button>
							</div>
						</div>
						<!-- // item contnets -->
					</div>
				</div>
			</div>
		</div>
		<div class="grid-row">
			<div class="item-box col-12">
				<div class="inner">
					<h4 class="item-title"><span class="iconWrapB icon_list"></span><strong>조회목록</strong></h4>
					<div class="items">
						<div class="tablewrap">
							<table>
								<thead class="tHead">
								</thead>
								<tbody class="tBody">
								</tbody>
							</table>
						</div>
						<div class="page_wrap">
							<div class="page_nation">
								<input type="hidden" name="rowPerPage" class="rowPerPage" value="9">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--//Grid-->
	</div>
</div>
<script th:inline="javascript">
	window.addEventListener('DOMContentLoaded', () => {
		ncos.schMode = 'auto';
		init();
		ncos.intervalFunc = setInterval(searchFunc, ncos.interval);//50초
		document.querySelector('.initBtn').addEventListener('click',e => {
	    	e.preventDefault();
			ncos.schMode = 'auto';
			ncos.initBtn = true;
			gfn_initObj(document.querySelector('.schwrap'));
			searchFunc();
			ncos.intervalFunc = setInterval(searchFunc, ncos.interval);//50초
	    });
	    document.querySelector('.schBtn').addEventListener('click',e => {
	    	e.preventDefault();
	    	ncos.schMode = 'menual';
	    	clearInterval(ncos.intervalFunc);
	    	searchFunc(e.target);
	    });

	});

    const init = () => {
    	//document.getElementById('frDt').value= gfn_getDiffDt(ncos.diffDay);
    	//document.getElementById('toDt').value= gfn_getTodayDt();
    	createChk(document.getElementById('schIndex'),'AIIX','전체');
    	const headColumns = [{data_id:"id",width: "0px"}
					        ,{data_id:"trainTime",label:"시간",data_dateFrmt:"yy-mm-dd hh:mi:ss"}
					        ,{data_id:"accuracy",label:"정확도" }
					        ,{data_id:"precision",label:"정밀도"}
					        ,{data_id:"recall",label:"재현율"}
					        ,{data_id:"f1score",label:"F1점수"}
					        ];
        gridInit(document.querySelector('.tablewrap'),headColumns);
		pageInit(document.querySelector(".page_nation"),searchFunc,page.rowPerPage);
		searchFunc();
    }

    const searchFunc = (invoker) => {
    	pageSearch("/getTrainList",document.querySelector(".tablewrap"),document.querySelector(".page_nation"),invoker,searchFunc,searchAfterFunc);
    }

    const searchAfterFunc = (appendData) => {
    	setTrainResult(appendData.info);
    }
    
    document.querySelector('.trainBtn').addEventListener('click',e => {
    	e.preventDefault();
	    gfn_asyncJsonCall('/execTrain','GET').then((data) => {
	    	console.log("data:",data);
	    	let msg = '정상적으로 처리되었습니다'
	    	if(data.callResult == '0'){
	    		msg = '학습 실행파일이 존재하지 않습니다.'
	    		msgCall(msg,false,false);
	    	}
	    	else if(data.callResult == '2'){
	    		msg = '예상되지 않은 오류가 발생하였습니다'
	    		msgCall(msg,false,false);
	    	}
	    	else{
	    		msgCall(msg,true,false);
	    	}
	    	
	    	
	 	});

    });

    const setTrainResult = (data) => {
    	document.querySelector('.resultTp').textContent = data.tp;
    	document.querySelector('.resultFp').textContent = data.fp;
    	document.querySelector('.resultFn').textContent = data.fn;
    	document.querySelector('.resultTn').textContent = data.tn;
    	
    }

</script>
</th:block>
</html>
