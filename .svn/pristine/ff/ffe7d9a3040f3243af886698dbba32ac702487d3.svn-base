<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Main">
   <select id="selectStatus" parameterType="map" resultType="CmmnMap">
        
     	SELECT 
     	       <if test='cyberDefense != null and !cyberDefense.equals("")'>
     	           <include refid="appendStatus"></include>
	          </if>
     	      
		      (SELECT COUNT(1)
				FROM asset_status_info A 
				INNER JOIN   
				(SELECT SYSTEM_ID,MAX(DETECTION_TIME) DETECTION_TIME
				FROM asset_status_info 
				GROUP BY SYSTEM_ID) B
				ON A.SYSTEM_ID = B.SYSTEM_ID
				AND A.DETECTION_TIME = B.DETECTION_TIME
				AND ASSET_STATUS != 2) UNSTABLE_ASSET
		     ,(SELECT COUNT(1) FROM network_asset_info) TOT_ASSET
		     ,(SELECT COUNT(1) FROM threat_info T1
               WHERE NOT EXISTS (SELECT T2.THREAT_ID FROM threat_analysis T2 WHERE T2.THREAT_ID = T1.THREAT_ID AND T2.ACTION_RESULT = 2)
               AND T1.THREAT_DETECTION_METHOD = '1'
		      ) WHITE_DETECT
		     ,(SELECT COUNT(1) FROM threat_info T1
               WHERE NOT EXISTS (SELECT T2.THREAT_ID FROM threat_analysis T2 WHERE T2.THREAT_ID = T1.THREAT_ID AND T2.ACTION_RESULT = 2)
               AND T1.THREAT_DETECTION_METHOD = '2'
		      ) AI_DETECT
		     ,(SELECT COUNT(1) FROM threat_info T1
               WHERE NOT EXISTS (SELECT T2.THREAT_ID FROM threat_analysis T2 WHERE T2.THREAT_ID = T1.THREAT_ID AND T2.ACTION_RESULT = 2)
               AND T1.THREAT_DETECTION_METHOD = '3'
		      ) SIGNATURE_DETECT
		     ,(SELECT COUNT(1) FROM threat_info T1
               WHERE NOT EXISTS (SELECT T2.THREAT_ID FROM threat_analysis T2 WHERE T2.THREAT_ID = T1.THREAT_ID AND T2.ACTION_RESULT = 2)
               AND  T1.THREAT_IMPORTANCE = '5'
		      ) HIGH_PRIOR
		     ,(SELECT COUNT(1) FROM threat_info T1
               WHERE NOT EXISTS (SELECT T2.THREAT_ID FROM threat_analysis T2 WHERE T2.THREAT_ID = T1.THREAT_ID AND T2.ACTION_RESULT = 2)
               AND T1.THREAT_IMPORTANCE = '3'
		       ) MIDDLE_PRIOR
		     ,(SELECT COUNT(1) FROM threat_info T1
               WHERE NOT EXISTS (SELECT T2.THREAT_ID FROM threat_analysis T2 WHERE T2.THREAT_ID = T1.THREAT_ID AND T2.ACTION_RESULT = 2)
               AND T1.THREAT_IMPORTANCE = '1'
		      ) LOW_PRIOR

  </select>
  
  <sql id="appendStatus">
       (SELECT  CYBER_DEF_GRADE FROM cyber_defense) CYBER_DEF_GRADE,
  </sql>
  
   <select id="selectThreatStatus" parameterType="map" resultType="CmmnMap">

     	SELECT TM.HM, ORD, CASE THTY WHEN  1 THEN 'H' WHEN 2 THEN 'A' ELSE 'S' END THREAT 
		     , SUM(CASE WHEN TI.THREAT_DETECTION_METHOD IS NULL THEN 0 ELSE 1 END) CNT
		FROM 
		(
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 1 THTY, 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 1 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 1 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 1 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 1 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 1 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 1 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 1 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 1 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 1 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 1 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 1 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 1 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 1 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 1,15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 1 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 1 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 1 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 1 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 1 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 1 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 1 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 1 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'), 1 ,24
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 2 THTY, 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 2 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 2 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 2 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 2 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 2 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 2 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 2 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 2 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 2 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 2 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 2 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 2 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 2 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 2, 15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 2 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 2 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 2 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 2 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 2 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 2 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 2 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 2 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'), 2,24
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 3 THTY, 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 3 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 3 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 3 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 3 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 3 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 3 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 3 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 3 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 3 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 3 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 3 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 3 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 3 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 3,15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 3 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 3 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 3 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 3 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 3 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 3 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 3 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 3 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'),3 ,24
		
		) TM 
		LEFT JOIN threat_info TI
		ON TM.HM = CONCAT(DATE_FORMAT(TI.DETECTION_TIME,"%H"),':00')
		AND TM.THTY = TI.THREAT_DETECTION_METHOD
		AND TI.DETECTION_TIME > DATE_ADD(NOW(), INTERVAL -24 HOUR)  
		GROUP BY HM,THTY,ORD
		ORDER BY THTY,ORD DESC
	



  </select>
  
  <select id="selectAssetStatus" parameterType="map" resultType="CmmnMap">

       SELECT TM.HM, ORD,ASLC ASSET
         , SUM(CASE WHEN ASSET_STATUS IS NULL THEN 0 ELSE 1 END) CNT
		FROM 
		(
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 1 ASLC, 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 1 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 1 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 1 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 1 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 1 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 1 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 1 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 1 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 1 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 1 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 1 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 1 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 1 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 1,15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 1 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 1 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 1 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 1 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 1 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 1 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 1 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 1 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'), 1 ,24
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 2 , 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 2 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 2 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 2 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 2 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 2 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 2 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 2 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 2 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 2 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 2 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 2 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 2 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 2 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 2, 15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 2 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 2 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 2 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 2 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 2 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 2 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 2 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 2 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'), 2,24
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 3, 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 3 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 3 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 3 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 3 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 3 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 3 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 3 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 3 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 3 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 3 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 3 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 3 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 3 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 3,15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 3 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 3 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 3 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 3 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 3 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 3 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 3 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 3 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'),3 ,24
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -23 HOUR),"%H"),':00')  HM, 4, 1 ORD
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -22 HOUR),"%H"),':00'), 4 , 2  
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -21 HOUR),"%H"),':00'), 4 ,3
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -20 HOUR),"%H"),':00'), 4 ,4
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -19 HOUR),"%H"),':00'), 4 ,5 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -18 HOUR),"%H"),':00'), 4 ,6
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -17 HOUR),"%H"),':00'), 4 ,7  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -16 HOUR),"%H"),':00'), 4 ,8
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -15 HOUR),"%H"),':00'), 4 ,9  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -14 HOUR),"%H"),':00'), 4 ,10
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -13 HOUR),"%H"),':00'), 4 ,11 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -12 HOUR),"%H"),':00'), 4 ,12 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -11 HOUR),"%H"),':00'), 4 ,13 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -10 HOUR),"%H"),':00'), 4 ,14  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -9 HOUR),"%H"),':00'), 4,15 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -8 HOUR),"%H"),':00'), 4 ,16 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -7 HOUR),"%H"),':00'), 4 ,17 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -6 HOUR),"%H"),':00'), 4 ,18 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -5 HOUR),"%H"),':00'), 4 ,19
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -4 HOUR),"%H"),':00'), 4 ,20  
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -3 HOUR),"%H"),':00'), 4 ,21 
			UNION 
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -2 HOUR),"%H"),':00'), 4 ,22 
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 HOUR),"%H"),':00'), 4 ,23
			UNION
			SELECT CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 0 HOUR),"%H"),':00'),4 ,24			) TM 
		LEFT JOIN (SELECt ASI.DETECTION_TIME, NSI.LARGE_CATEGORY,ASI.ASSET_STATUS
		           FROM asset_status_info ASI
		           INNER JOIN network_asset_info NSI
		           ON ASI.SYSTEM_ID = NSI.SYSTEM_ID 
		           AND ASI.ASSET_STATUS != 2
		           AND ASI.DETECTION_TIME > DATE_ADD(NOW(), INTERVAL -24 HOUR)
		           ) ASI
		ON TM.HM = CONCAT(DATE_FORMAT(ASI.DETECTION_TIME,"%H"),':00')
		AND TM.ASLC = ASI.LARGE_CATEGORY
		GROUP BY HM,ASLC,ORD
		ORDER BY ASLC,ORD DESC


  </select>
  
  <select id="selectDataTransStatus" parameterType="map" resultType="CmmnMap">
        
         
        SELECT SUM(SRC_BYTES) SRC_BYTES, TIMESTAMPDIFF(second,  SRC_TIME,#{curTime}) SEC
        FROM transmit_data 
        WHERE  SRC_TIME > DATE_ADD(#{curTime}, INTERVAL -60 SECOND) 
        AND SRC_BYTES IS NOT NULL
        GROUP BY TIMESTAMPDIFF(second,  SRC_TIME,#{curTime}) 
        ORDER BY TIMESTAMPDIFF(second,  SRC_TIME,#{curTime}) DESC
        
    
  </select>
  
  <select id="selectTotDataTransStatus" parameterType="map" resultType="long">
        SELECT 
        IFNULL((SELECT SUM(JSON_BYTES) SRC_BYTES
        FROM transmit_data 
        WHERE  SRC_DATA IS NOT NULL
        AND SRC_FLAG = 0),0)
  </select>

</mapper>